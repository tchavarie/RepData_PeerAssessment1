total <- with(NEI, tapply(Emissions, year, sum, na.rm = TRUE))
hist(total)
str(total)
hist(total, "year")
?hist
hist(total, names(total))
hist(total, names(total))
hist(total, as.numeric(names(total)))
hist(total, as.factor(names(total)))
hist(total, breaks=5)
hist(total, breaks=1)
hist(total, breaks=2000)
hist(total, breaks=5)
str(total)
plot(names(total), total)
plot(names(total), total, pch = 20)
str(total)
?plot
plot(names(total), total, pch = 20, type = 'h')
plot(names(total), total, type = 'h')
plot(names(total), total, pch = 20)
lines(lowess(total))
lines(lowess(total))
plot(names(total), total, pch = 20)
lines(lowess(total))
plot(names(total), format(total, scientific = FALSE), pch = 20)
plot(names(total), formatC(total, digits = 0, format = "f"), pch = 20)
plot(names(total), formatC(total, digits = 0, format = "f"), pch = 20)
plot(names(total), formatC(total, format = "d"), pch = 20)
plot(names(total), total, pch = 20)
plot(names(total), total, pch = 20, las = 1)
plot(names(total), total, pch = 20, las = 1)
par(mar(5,6,3,1))
plot(names(total), total, pch = 20, las = 1)
par(mar(5,8,3,1))
plot(names(total), total, pch = 20, las = 1)
plot(names(total), total, pch = 20, las = 1)
abline(lm(total ~ names(total))
abline(lm(total ~ names(total)))
abline(lm(total ~ as.numeric(names(total))))
plot(names(total), total, pch = 20, las = 1, ylab = "Total Emissions", xlab = "Year")
plot(names(total), total, pch = 20, ylab = "Total Emissions", xlab = "Year")
abline(lm(total ~ as.numeric(names(total))))
barplot(height = total)
barplot(total)
barplot(total, ylab = "Total Emissions", xlab = "Year")
barplot(total, ylab = "Total Emissions", xlab = "Year", main = "Total PM2.5 emission from all sources")
barplot(total, ylab = "Total Emission", xlab = "Year", main = "Total PM2.5 emission from all sources")
total <- with(NEI, tapply(Emissions, year, sum, na.rm = TRUE))
png('plot1.png')
barplot(total, ylab = "Total Emission", xlab = "Year", main = "Total PM2.5 emission from all sources")
dev.off()
str(NEI)
bal <- subset(NIE, fips == "ðŸ¸ðŸºðŸ»ðŸ·ðŸ¶")
bal <- subset(NEI, fips == "ðŸ¸ðŸºðŸ»ðŸ·ðŸ¶")
total <- with(bal, tapply(Emissions, year, sum, na.rm = TRUE))
barplot(total, ylab = "Total Emission", xlab = "Year", main = "Total PM2.5 emission from all sources")
bal <- subset(NEI, fips == "ðŸ¸ðŸºðŸ»ðŸ·ðŸ¶")
total <- with(bal, tapply(Emissions, year, sum, na.rm = TRUE))
#png('plot1.png')
barplot(total, ylab = "Total Emission", xlab = "Year", main = "Total PM2.5 emission from all sources")
str(bal)
str(NEI)
subset(NEI, fips == "ðŸ¸ðŸºðŸ»ðŸ·ðŸ¶")
NEI[NEI$fips == "24510", ]
bal <- NEI[NEI$fips == "24510", ]
total <- with(bal, tapply(Emissions, year, sum, na.rm = TRUE))
barplot(total, ylab = "Total Emission", xlab = "Year", main = "Total PM2.5 emission from all sources")
barplot(total, ylab = "Total Emission", xlab = "Year", main = "Total PM2.5 emission Baltimore City")
?subset
subset(NEI, fips == "24510", select = c(Emissions, year))
bal <- subset(NEI, fips == "24510", select = c(Emissions, year))
total <- with(bal, tapply(Emissions, year, sum, na.rm = TRUE))
barplot(total, ylab = "Total Emission", xlab = "Year", main = "Total PM2.5 emission Baltimore City")
bal <- NEI[NEI$fips == "24510", ]
bal <- NEI[NEI$fips == "24510", ]
bal <- NEI[NEI$fips == "24510", ]
bal <- NEI[NEI$fips == "24510", ]
total <- with(bal, tapply(Emissions, year, sum, na.rm = TRUE))
#png('plot1.png')
barplot(total, ylab = "Total Emission", xlab = "Year", main = "Total PM2.5 emission Baltimore City")
bal <- NEI[NEI$fips == "24510", ]
total <- with(bal, tapply(Emissions, year, sum, na.rm = TRUE))
#png('plot1.png')
barplot(total, ylab = "Total Emission", xlab = "Year", main = "Total PM2.5 emission Baltimore City")
#dev.off()
bal <- subset(NEI, fips == "24510", select = c(Emissions, year))
#bal <- NEI[NEI$fips == "24510", ]
total <- with(bal, tapply(Emissions, year, sum, na.rm = TRUE))
#png('plot1.png')
barplot(total, ylab = "Total Emission", xlab = "Year", main = "Total PM2.5 emission Baltimore City")
bal <- subset(NEI, fips == "24510", select = c(Emissions, year))
total <- with(bal, tapply(Emissions, year, sum, na.rm = TRUE))
png('plot2.png')
barplot(total, ylab = "Total Emission", xlab = "Year", main = "Total PM2.5 emission Baltimore City")
dev.off()
abline(lm(total ~ as.numeric(names(total))))
bal <- subset(NEI, fips == "24510", select = c(Emissions, year))
total <- with(bal, tapply(Emissions, year, sum, na.rm = TRUE))
#png('plot2.png')
barplot(total, ylab = "Total Emission", xlab = "Year", main = "Total PM2.5 emission Baltimore City")
abline(lm(total ~ as.numeric(names(total))))
bal <- subset(NEI, fips == "24510", select = c(Emissions, year))
total <- with(bal, tapply(Emissions, year, sum, na.rm = TRUE))
png('plot2.png')
barplot(total, ylab = "Total Emission", xlab = "Year", main = "Total PM2.5 emission Baltimore City")
dev.off()
str(NEI)
subset(NEI, fips == "24510", select = c(Emissions, type))
bal <- subset(NEI, fips == "24510", select = c(Emissions, type))
str(bal)
str(NEI)
bal <- subset(NEI, fips == "24510", select = c(Emissions, year, type))
str(bal)
with(bal, qplot(year, Emissions, facets = . ~ type)
with(bal, qplot(year, Emissions, facets = . ~ type))
library(ggplot2)
with(bal, qplot(year, Emissions, facets = . ~ type))
with(bal, qplot(year, Emissions, facets = . ~ type, geom = c("point","smooth")))
pf <- read.csv("/Users/tyson/DataScienceCourse/EDA_Course_Materials/lesson3/pseudo_facebook.tsv", sep = "\t")
qplot(x=dob_day, data = pf) +
scale_x_continuous(breaks=1:31) +
facet_wrap(~dob_month, ncol = 3)
with(bal, qplot(year, Emissions, facets = . ~ type))
with(bal, qplot(year, Emissions, col = type))
with(bal, qplot(year, Emissions, facets = . ~ type))
with(bal, qplot(factor(year), Emissions, facets = . ~ type))
with(bal, qplot(year, Emissions, facets = . ~ type))
?qplot
with(bal, qplot(year, Emissions, facets = . ~ type), geom = "bar")
with(bal, qplot(year, Emissions, facets = . ~ type, geom = "bar"))
with(bal, qplot(year, Emissions, facets = . ~ type, geom = "bar"))
range(bal$Emissions)
summary(bal$Emissions)
g <- ggplot(bal, aes(x = year, y = Emissions))
g + geom_line()
g + geom_line() + coord_cartesian(ylim = c(0,3))
with(bal, qplot(year, Emissions, facets = . ~ type, geom = "bar"))
with(bal, qplot(year, Emissions, facets = . ~ type)
with(bal, qplot(year, Emissions, facets = . ~ type))
?qplot
with(bal, qplot(year, Emissions, facets = . ~ type))
baltimoreNEI <- NEI[NEI$fips=="24510",]
# Aggregate using sum the Baltimore emissions data by year
aggTotalsBaltimore <- aggregate(Emissions ~ year, baltimoreNEI,sum)
ggp <- ggplot(baltimoreNEI,aes(factor(year),Emissions,fill=type)) +
geom_bar(stat="identity") +
theme_bw() + guides(fill=FALSE)+
facet_grid(.~type,scales = "free",space="free") +
labs(x="year", y=expression("Total PM"[2.5]*" Emission (Tons)")) +
labs(title=expression("PM"[2.5]*" Emissions, Baltimore City 1999-2008 by Source Type"))
print(ggp)
View(aggTotalsBaltimore)
View(aggTotalsBaltimore)
rm(aggTotalsBaltimore)
baltimoreNEI <- NEI[NEI$fips=="24510",]
ggp <- ggplot(baltimoreNEI,aes(factor(year),Emissions,fill=type)) +
geom_bar(stat="identity") +
theme_bw() + guides(fill=FALSE)+
facet_grid(.~type,scales = "free",space="free") +
labs(x="year", y=expression("Total PM"[2.5]*" Emission (Tons)")) +
labs(title=expression("PM"[2.5]*" Emissions, Baltimore City 1999-2008 by Source Type"))
print(ggp)
qplot(data = bal, x = year, Emissions, facets = . ~ type)
ggplot(bal,aes(year,Emissions)
ggplot(bal,aes(year,Emissions) +
geom_bar()
source('~/DataScienceCourse/EDACourseProject/plot3.R', echo=TRUE)
source('~/DataScienceCourse/EDACourseProject/plot3.R', echo=TRUE)
source('~/DataScienceCourse/EDACourseProject/plot3.R', echo=TRUE)
ggplot(bal,aes(year,Emissions) +
geom_bar() +
facet_grid(.~type)
ggplot(bal,aes(year,Emissions))
ggplot(bal,aes(year,Emissions))
ggplot(bal,aes(year,Emissions)) +
geom_bar()
?geom_bar
ggplot(bal,aes(year,Emissions)) +
geom_bar(stat = "identity")
ggplot(bal,aes(factor(year),Emissions)) +
geom_bar(stat = "identity")
ggplot(bal,aes(factor(year),Emissions)) +
geom_bar(stat = "identity") +
facet_grid(.~type)
ggplot(bal,aes(factor(year),Emissions, fill=type)) +
geom_bar(stat = "identity") +
facet_grid(.~type)
total <- with(bal, tapply(Emissions, year, sum, na.rm = TRUE))
str(total)
class(bal)
aggregate(x = bal, by = list(Emissions, Year), FUN = "sum")
aggregate(bal$Emissions, by=list(year = bal$year, type = bal$type), FUN=sum)
total <- aggregate(bal$Emissions, by=list(year = bal$year, type = bal$type), FUN=sum)
str(total)
ggplot(total,aes(factor(year),Emissions, fill=type)) +
geom_bar() +
facet_grid(.~type)
ggplot(total,aes(factor(year), x, fill=type)) +
geom_bar() +
facet_grid(.~type)
ggplot(total,aes(factor(year), x, fill=type))
facet_grid(.~type)
ggplot(bal,aes(factor(year),Emissions, fill=type)) +
geom_bar(stat = "identity") +
facet_grid(.~type)
?qplot
qplot(data = total, x = year, y = x)
qplot(data = total, x = year, y = x, facets = . ~ type)
ggplot(bal,aes(factor(year),Emissions, fill=type)) +
geom_bar(stat = "identity") +
facet_grid(.~type)
ggplot(bal,aes(factor(year),Emissions, fill=type)) +
geom_bar(stat = "identity") +
facet_grid(.~type)
ggplot(total,aes(factor(year),x, fill=type)) +
geom_bar(stat = "identity") +
facet_grid(.~type)
ggplot(bal,aes(factor(year),Emissions, fill=type)) +
geom_bar(stat = "identity") +
facet_grid(.~type)
with(total, by(year, x, summary))
with(total, by(x, year, summary))
with(total, by(x, factor(year), summary))
with(bal, by(Emissions, factor(year), summary))
subset(bal, type == "NONPONT" & year == "1999", select = Emissions)
subset(bal, type == "NONPOINT" & year == "1999", select = Emissions)
sum(subset(bal, type == "NONPOINT" & year == "1999", select = Emissions))
source('~/DataScienceCourse/EDACourseProject/plot3.R', echo=TRUE)
ggplot(bal,aes(factor(year),Emissions, fill=type)) +
geom_bar(stat = "identity") +
facet_grid(.~type)
str(NEI)
ggplot(bal,aes(factor(year),Emissions, fill=type)) +
geom_bar(stat = "identity") +
facet_grid(.~type) +
labs(x="Year", y="Total Emissions", main="Total Emissions Balimore City by Source Type")
labs(x="Year", y="Total Emissions", title="Total Emissions Balimore City by Source Type")
source('~/DataScienceCourse/EDACourseProject/plot3.R', echo=TRUE)
ggplot(bal,aes(factor(year),Emissions, fill=type)) +
geom_bar(stat = "identity") +
facet_grid(.~type) +
labs(x="Year", y="Total Emissions", title="Total Emissions Balimore City by Source Type")
bal <- subset(NEI, fips == "24510", select = c(Emissions, year, type))
library(ggplot2)
png('plot2.png')
ggplot(bal,aes(factor(year),Emissions, fill=type)) +
geom_bar(stat = "identity") +
facet_grid(.~type) +
labs(x="Year", y="Total Emissions", title="Total Emissions Balimore City by Source Type")
dev.off()
bal <- subset(NEI, fips == "24510", select = c(Emissions, year, type))
library(ggplot2)
png('plot3.png')
ggplot(bal,aes(factor(year),Emissions, fill=type)) +
geom_bar(stat = "identity") +
facet_grid(.~type) +
labs(x="Year", y="Total Emissions", title="Total Emissions Balimore City by Source Type")
dev.off()
bal <- subset(NEI, fips == "24510", select = c(Emissions, year))
total <- with(bal, tapply(Emissions, year, sum, na.rm = TRUE))
png('plot2.png')
barplot(total, ylab = "Total Emission", xlab = "Year", main = "Total PM2.5 emission Baltimore City")
dev.off()
bal <- subset(NEI, fips == "24510", select = c(Emissions, year, type))
library(ggplot2)
png('plot3.png')
ggplot(bal,aes(factor(year),Emissions, fill=type)) +
geom_bar(stat = "identity") +
facet_grid(.~type) +
labs(x="Year", y="Total Emissions", title="Total Emissions Balimore City by Source Type")
dev.off()
names(SCC)
coal <- subset(SCC, grepl("[Cc]oal",EI.Sector), select = c(SCC, EI.Sector))
head(coal)
names(NEI)
coal[[1]]
coal <- subset(SCC, grepl("[Cc]oal",EI.Sector), select = c(SCC, EI.Sector))
us <- subset(NEI, SCC %in% coal[[1]], select = c(Emissions, year))
par(mfrow=c(1, 2))
total <- with(us, tapply(Emissions, year, sum, na.rm = TRUE))
barplot(total, ylab = "Total Emission", xlab = "Year", main = "Total PM2.5 emission from all sources")
barplot(us, ylab = "Total Emission", xlab = "Year", main = "Total PM2.5 emission from all sources")
total <- with(us, tapply(Emissions, year, sum, na.rm = TRUE))
#png('plot4.png')
par(mfrow=c(1, 2))
barplot(total, ylab = "Total Emission", xlab = "Year", main = "Total PM2.5 emission from all sources")
barplot(us, ylab = "Total Emission", xlab = "Year", main = "Total PM2.5 emission from all sources")
coal <- subset(SCC, grepl("[Cc]oal",EI.Sector), select = c(SCC, EI.Sector))
us <- subset(NEI, SCC %in% coal[[1]], select = c(Emissions, year))
total <- with(us, tapply(Emissions, year, sum, na.rm = TRUE))
#png('plot4.png')
barplot(total, ylab = "Total Emission", xlab = "Year", main = "Total PM2.5 emission from all sources")
#dev.off()
barplot(total, ylab = "Total Emission", xlab = "Year", main = "Total PM2.5 emission - Coal Sources")
coal <- subset(SCC, grepl("[Cc]oal",EI.Sector), select = c(SCC, EI.Sector))
us <- subset(NEI, SCC %in% coal[[1]], select = c(Emissions, year))
total <- with(us, tapply(Emissions, year, sum, na.rm = TRUE))
png('plot4.png')
barplot(total, ylab = "Total Emission", xlab = "Year", main = "Total PM2.5 emission - Coal Sources")
dev.off()
mv <- subset(SCC, grepl("[Vv]ehicle",EI.Sector), select = c(SCC, EI.Sector))
bal <- subset(NEI, fips == "24510" & SCC %in% coal[[1]], select = c(Emissions, year))
total <- with(bal, tapply(Emissions, year, sum, na.rm = TRUE))
#png('plot5.png')
barplot(total, ylab = "Total Emission", xlab = "Year", main = "Total PM2.5 emission - Coal Sources")
mv <- subset(SCC, grepl("[Vv]ehicle",EI.Sector), select = c(SCC, EI.Sector))
bal <- subset(NEI, fips == "24510" & SCC %in% mv[[1]], select = c(Emissions, year))
total <- with(bal, tapply(Emissions, year, sum, na.rm = TRUE))
#png('plot5.png')
barplot(total, ylab = "Total Emission", xlab = "Year", main = "Total PM2.5 emission - Coal Sources")
barplot(total, ylab = "Total Emission", xlab = "Year", main = "Total PM2.5 emission - Motor Vehicle Sources")
mv <- subset(SCC, grepl("[Vv]ehicle",EI.Sector), select = c(SCC, EI.Sector))
bal <- subset(NEI, fips == "24510" & SCC %in% mv[[1]], select = c(Emissions, year))
total <- with(bal, tapply(Emissions, year, sum, na.rm = TRUE))
png('plot5.png')
barplot(total, ylab = "Total Emission", xlab = "Year", main = "Total PM2.5 emission - Motor Vehicle Sources")
dev.off()
mv <- subset(SCC, grepl("[Vv]ehicle",EI.Sector), select = c(SCC, EI.Sector))
mv <- subset(SCC, grepl("[Vv]ehicle",EI.Sector), select = c(SCC, EI.Sector))
dat <- subset(NEI, (fips == "24510" | fips == "06037í¿¶ðŸ¹ðŸ½") & SCC %in% mv[[1]], select = c(Emissions, year))
library(ggplot2)
ggplot(dat,aes(factor(year),Emissions, fill=type)) +
geom_bar(stat = "identity") +
facet_grid(.~type) +
labs(x="Year", y="Total Emissions", title="Total Emissions Balimore City by Source Type")
dat <- subset(NEI, (fips == "24510" | fips == "06037í¿¶ðŸ¹ðŸ½") & SCC %in% mv[[1]], select = c(Emissions, year))
dat <- subset(NEI, (fips == "24510" | fips == "06037") & SCC %in% mv[[1]], select = c(Emissions, year))
library(ggplot2)
ggplot(dat,aes(factor(year),Emissions, fill=type)) +
geom_bar(stat = "identity") +
facet_grid(.~type) +
labs(x="Year", y="Total Emissions", title="Total Emissions Balimore City by Source Type")
dat <- subset(NEI, (fips == "24510" | fips == "06037") & SCC %in% mv[[1]], select = c(Emissions, year, fips))
ggplot(dat,aes(factor(year),Emissions, fill=fips)) +
geom_bar(stat = "identity") +
facet_grid(.~fips) +
labs(x="Year", y="Total Emissions", title="Total Emissions Balimore City by Source Type")
ggplot(dat,aes(factor(year),Emissions, fill=fips)) +
geom_bar(stat = "identity") +
facet_grid(.~fips) +
labs(x="Year", y="Total Emissions", title="Motor Vehicle Emissions - Baltimore City vs. Los Angeles County")
labs(x="Year", y="Total Emissions", title="Motor Vehicle Emissions - Los Angeles County vs. Baltimore City")
source('~/DataScienceCourse/EDACourseProject/plot6.R', echo=TRUE)
ggplot(dat,aes(factor(year),Emissions, fill=fips)) +
geom_bar(stat = "identity") +
facet_grid(.~fips) +
labs(x="Year", y="Total Emissions", title="Motor Vehicle Emissions - Los Angeles County vs. Baltimore City") +
stat_smooth()
ggplot(dat,aes(factor(year),Emissions, fill=fips)) +
geom_bar(stat = "identity") +
facet_grid(.~fips) + stat_smooth() +
labs(x="Year", y="Total Emissions", title="Motor Vehicle Emissions - Los Angeles County vs. Baltimore City")
ggplot(dat,aes(factor(year),Emissions, fill=fips)) +
# geom_bar(stat = "identity") +
facet_grid(.~fips) +
labs(x="Year", y="Total Emissions", title="Motor Vehicle Emissions - Los Angeles County vs. Baltimore City")
ggplot(dat,aes(factor(year),Emissions, fill=fips)) +
geom_bar(stat = "identity") +
facet_grid(.~fips) +
labs(x="Year", y="Total Emissions", title="Motor Vehicle Emissions - Los Angeles County vs. Baltimore City")
ggplot(dat,aes(factor(year),Emissions, fill=fips)) +
geom_bar(stat = "identity") +
facet_grid(.~fips) +
labs(x="Year", y="Total Emissions", title="Motor Vehicle Emissions - Los Angeles County vs. Baltimore City") +
geom_smooth(data=dat,
aes(factor(year),Emissions),
method="lm", size=2, color="darkblue")
ggplot(dat,aes(factor(year),Emissions, fill=fips)) +
geom_bar(stat = "identity") +
facet_wrap(~fips) +
labs(x="Year", y="Total Emissions", title="Motor Vehicle Emissions - Los Angeles County vs. Baltimore City")
ggplot(dat,aes(factor(year),Emissions, fill=fips)) +
geom_bar(stat = "identity") +
facet_wrap(~fips) + geom_smooth(aes(group=1), method='lm', se=FALSE)
labs(x="Year", y="Total Emissions", title="Motor Vehicle Emissions - Los Angeles County vs. Baltimore City")
ggplot(dat,aes(factor(year),Emissions, fill=fips)) +
geom_bar(stat = "identity") +
facet_wrap(~fips) + geom_smooth(aes(Emissions), method='lm', se=FALSE)
labs(x="Year", y="Total Emissions", title="Motor Vehicle Emissions - Los Angeles County vs. Baltimore City")
ggplot(dat,aes(factor(year),Emissions, fill=fips)) +
geom_bar(stat = "identity") +
facet_wrap(~fips) + geom_smooth(aes(factor(year,Emissions), method='lm', se=FALSE)
labs(x="Year", y="Total Emissions", title="Motor Vehicle Emissions - Los Angeles County vs. Baltimore City")
ggplot(dat,aes(factor(year),Emissions, fill=fips)) +
geom_bar(stat = "identity") +
facet_wrap(~fips) + geom_smooth(aes(factor(year,Emissions), method='lm', se=FALSE))
labs(x="Year", y="Total Emissions", title="Motor Vehicle Emissions - Los Angeles County vs. Baltimore City")
ggplot(dat,aes(factor(year),Emissions, fill=fips)) +
geom_bar(stat = "identity") +
facet_wrap(~fips) +
labs(x="Year", y="Total Emissions", title="Motor Vehicle Emissions - Los Angeles County vs. Baltimore City")
mv <- subset(SCC, grepl("[Vv]ehicle",EI.Sector), select = c(SCC, EI.Sector))
dat <- subset(NEI, (fips == "24510" | fips == "06037") & SCC %in% mv[[1]], select = c(Emissions, year, fips))
library(ggplot2)
png('plot6.png')
ggplot(dat,aes(factor(year),Emissions, fill=fips)) +
geom_bar(stat = "identity") +
facet_wrap(~fips) +
dev.off()
labs(x="Year", y="Total Emissions", title="Motor Vehicle Emissions - Los Angeles County vs. Baltimore City")
getwd()
png('plot6.png')
ggplot(dat,aes(factor(year),Emissions, fill=fips)) +
geom_bar(stat = "identity") +
facet_wrap(~fips) +
labs(x="Year", y="Total Emissions", title="Motor Vehicle Emissions - Los Angeles County vs. Baltimore City")
dev.off()
data(spam)
install.packages(kernlab)
install.packages("kernlab")
library(kernlab)
data(spam)
str(spam[, 1:5])
set.seed(3435)
trainIndicator = rbinom(4601, size = 1, prob = 0.5)
table(trainIndicator)
trainSpam = spam[trainIndicator == 1, ]
testSpam = spam[trainIndicator == 0, ]
names(trainSpam)
head(trainSpam)
table(trainSpam$type)
plot(trainSpam$capitalAve ~ trainSpam$type)
plot(log10(trainSpam$capitalAve + 1) ~ trainSpam$type)
plot(log10(trainSpam[, 1:4]+1))
hCluster = hclust(dist(t(trainSpam[, 1:57])))
plot(hCluster)
hCluster = hclust(dist(t(trainSpam[, 1:57])))
plot(hCluster)
hClusterUpdated = hclust(dist(t(log10(trainSpam[, 1:55]))))
hClusterUpdated = hclust(dist(t(log10(trainSpam[, 1:55]+1))))
plot(hClusterUpdated)
trainSpam$numType = as.numeric(trainSpam$type) - 1
costFunction = function(x, y) sum(x != (y > 0.5))
cvError = rep(NA, 5)
library(boot)
for (i in 1:55) {
lmFormula = reformulate(names(trainSpam)[i], response = "numType")
glmFit = glm(lmFormula, family = "binomial", data = trainSpam)
cvError[i] = cv.glm(trainSpam, glmFit, costFunction, 2)$delta[2]
}
names(trainSpam)[which.min(cvError)]
predictionModel = glm(numType ~ charDollar, family = "binomial", ddata = trainSpam)
lmFormula
predictionModel = glm(numType ~ charDollar, family = "binomial", data = trainSpam)
predictionTest = predict(predictionModel, testSpam)
predictedSpam = rep("nonspam", dim(testSpam)[1])
predictedSpam[predictionModel$fitted > 0.5] = "spam"
predictedSpam
table(predictedSpam, testSpam$type)
(61 + 458)/(1346 + 458 + 61 + 449)
table(predictedSpam)
table(testSpam$type)
trainSpam$numType = as.numeric(trainSpam$type) - 1
costFunction = function(x, y) sum(x != (y > 0.5))
cvError = rep(NA, 5)
library(boot)
for (i in 1:55) {
lmFormula = reformulate(names(trainSpam)[i], response = "numType")
glmFit = glm(lmFormula, family = "binomial", data = trainSpam)
cvError[i] = cv.glm(trainSpam, glmFit, costFunction, 2)$delta[2]
}
## Which predictor has minimum cross-validated error?
names(trainSpam)[which.min(cvError)]
## Use the best model from the group
predictionModel = glm(numType ~ charDollar, family = "binomial", data = trainSpam)
## Get Predictions on the test set
predictionTest = predict(predictionModel, testSpam)
predictedSpam = rep("nonspam", dim(testSpam)[1])
## Classify as 'spam' for those with prob > 0.5
predictedSpam[predictionModel$fitted > 0.66] = "spam"
## Classification table
table(predictedSpam, testSpam$type)
table(predictedSpam)
table(testSpam$type)
##
(44 + 519)/(1346 + 458 + 61 + 449)
install.packages('ProjectTemplate')
if(!file.exists("./data")) {dir.create("./data")}
fileUrl = "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"
download.file(fileUrl, destfile = "./data/RRactivityData.zip", method="curl")
# Unzip files
unzip("./data/RRactivityData.zip", exdir = "./data")
getwd()
setwd("/Users/tyson/DataScienceCourse")
if(!file.exists("./data")) {dir.create("./data")}
fileUrl = "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"
download.file(fileUrl, destfile = "./data/RRactivityData.zip", method="curl")
# Unzip files
unzip("./data/RRactivityData.zip", exdir = "./data")
?read.csv
activity <- read.csv(file = "./data/activity.csv")
head(activity)
setwd(/Users/tyson/GitHub/RRProject1)
setwd("/Users/tyson/GitHub/RRProject1")
# Create data directory and download project files
if(!file.exists("./data")) {dir.create("./data")}
fileUrl = "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"
download.file(fileUrl, destfile = "./data/RRactivityData.zip", method="curl")
# Unzip files
unzip("./data/RRactivityData.zip", exdir = "./data")
activity <- read.csv(file = "./data/activity.csv")
head(activity)
activity <- read.csv(file = "./data/activity.zip")
getwd()
setwd("/Users/tyson/GitHub/RepData_PeerAssessment1")
activity <- read.csv(file = "activity.zip")
head(activity)
?unzip
unzip("activity.zip")
activity <- read.csv(file = "activity.csv")
head(activity)
